# 🔍 插件调试指南

## 问题：按 Ctrl+Shift+P 没有反应

### 可能的原因和解决方案

#### 1. 插件未正确激活

**检查方法：**

- 启动调试模式后，应该看到两个信息提示：
  - "AI 翻译插件已激活！"
  - "AI 翻译插件命令已注册完成！"

**如果没有看到这些提示：**

- 检查 `out/extension.js` 文件是否存在
- 重新编译：`npm run compile`
- 重新启动调试模式

#### 2. 命令面板快捷键问题

**尝试以下方法：**

**方法 1：使用菜单**

- 点击 "查看" → "命令面板"
- 或使用菜单栏的 "帮助" → "显示所有命令"

**方法 2：使用其他快捷键**

- Mac: `Cmd+Shift+P`
- Windows/Linux: `Ctrl+Shift+P`
- 或者按 `F1` 键

**方法 3：直接搜索命令**

- 在命令面板中输入 "AI 翻译"
- 应该能看到三个命令：
  - AI 翻译: 翻译整个文件
  - AI 翻译: 翻译选中内容
  - AI 翻译: 打开设置

#### 3. 检查插件状态

**在扩展开发主机窗口中：**

1. 按 `Ctrl+Shift+P` 打开命令面板
2. 输入 "Developer: Reload Window"
3. 重新加载窗口
4. 查看是否出现激活提示

#### 4. 查看调试信息

**在原始 VSCode 窗口中：**

1. 打开 "调试控制台" 面板
2. 查看是否有错误信息
3. 应该看到类似这样的日志：
   ```
   AI Translate Wiki插件已激活
   开始注册命令...
   所有命令注册完成
   ```

## 🚀 完整测试步骤

### 步骤 1：重新编译

```bash
cd /Users/lemon/Desktop/lemon-\ translate
npm run compile
```

### 步骤 2：启动调试模式

1. 在 VSCode 中按 `F5`
2. 等待新窗口打开
3. 查看是否出现激活提示

### 步骤 3：测试命令面板

1. 在新窗口中按 `Ctrl+Shift+P`（或 `Cmd+Shift+P`）
2. 如果命令面板没有打开，尝试：
   - 按 `F1` 键
   - 点击 "查看" → "命令面板"
   - 点击 "帮助" → "显示所有命令"

### 步骤 4：搜索命令

1. 在命令面板中输入 "AI 翻译"
2. 应该看到三个命令选项
3. 选择 "AI 翻译: 打开设置"

### 步骤 5：测试状态栏

1. 查看右下角状态栏
2. 应该看到 "🌐 AI 翻译" 按钮
3. 点击该按钮应该打开设置面板

## 🐛 常见问题解决

### 问题 1：命令面板完全无法打开

**解决方案：**

- 检查 VSCode 版本是否支持
- 尝试重启 VSCode
- 检查键盘快捷键设置

### 问题 2：命令面板打开但没有 AI 翻译命令

**解决方案：**

- 确保插件已激活（看到激活提示）
- 重新编译项目
- 重新加载窗口

### 问题 3：命令存在但点击无反应

**解决方案：**

- 查看调试控制台的错误信息
- 检查 API 配置是否正确
- 确保所有依赖文件都存在

### 问题 4：设置面板无法打开

**解决方案：**

- 检查 Webview 相关代码是否正确编译
- 查看控制台错误信息
- 尝试重新加载窗口

## 📊 调试检查清单

### 基础检查

- [ ] 项目编译成功（无错误）
- [ ] 调试模式启动正常
- [ ] 新窗口打开成功
- [ ] 看到插件激活提示

### 命令检查

- [ ] 命令面板能够打开
- [ ] 能够搜索到 AI 翻译命令
- [ ] 命令点击有反应
- [ ] 状态栏显示 AI 翻译按钮

### 功能检查

- [ ] 设置面板能够打开
- [ ] 能够配置 API 设置
- [ ] 翻译功能正常工作
- [ ] 错误处理正常

## 🔧 高级调试

### 查看详细日志

1. 在原始 VSCode 窗口中打开 "调试控制台"
2. 查看所有日志输出
3. 寻找错误信息

### 检查文件结构

```bash
# 检查编译输出
ls -la out/
ls -la out/extension.js

# 检查文件大小
du -h out/extension.js
```

### 手动测试命令

1. 在调试控制台中输入：
   ```javascript
   vscode.commands.getCommands().then((commands) => {
     console.log(commands.filter((cmd) => cmd.includes("ai-translate")));
   });
   ```

## 💡 提示

1. **首次调试**：建议先确保插件能够正常激活
2. **逐步测试**：先测试基础功能，再测试复杂功能
3. **查看日志**：调试控制台中的日志信息很重要
4. **重新加载**：遇到问题时尝试重新加载窗口

如果按照上述步骤仍然无法解决问题，请提供具体的错误信息或日志内容。
