# 🔍 翻译问题调试指南

## 问题：翻译出来的文件还是中文

### 可能的原因和解决方案

#### 1. API 配置问题

**检查项目：**

- API 密钥是否正确配置
- API 端点是否正确
- 目标语言设置是否正确

**调试步骤：**

1. 按 `Ctrl+Shift+P` 打开命令面板
2. 输入 "AI 翻译: 测试翻译功能"
3. 查看测试结果和调试信息

#### 2. API 响应问题

**可能原因：**

- API 返回了错误信息
- API 返回了中文提示而不是翻译结果
- 网络连接问题

**调试方法：**

1. 查看 VSCode 调试控制台的日志
2. 检查 API 响应内容
3. 验证 API 密钥和端点

#### 3. Prompt 问题

**已修复：**

- 将中文 prompt 改为英文 prompt
- 明确指定翻译要求
- 强调只返回翻译结果

## 🚀 调试步骤

### 步骤 1：使用测试功能

```bash
# 编译项目
npm run compile

# 在VSCode中按 F5 启动调试模式
```

1. 在新窗口中按 `Ctrl+Shift+P`
2. 输入 "AI 翻译: 测试翻译功能"
3. 查看测试结果

### 步骤 2：检查配置

1. 按 `Ctrl+Shift+P` 打开命令面板
2. 输入 "AI 翻译: 打开设置"
3. 检查以下配置：
   - **API 提供商**: 确保选择了正确的服务
   - **API 密钥**: 确保密钥正确
   - **目标语言**: 确保选择了目标语言（如 English）
   - **API 端点**: 如果使用自定义端点，确保正确

### 步骤 3：查看调试日志

1. 在原始 VSCode 窗口中打开"调试控制台"
2. 查看以下日志信息：
   ```
   开始翻译，API提供商: deepseek, 目标语言: en
   原文长度: 50 字符
   翻译完成，结果长度: 45 字符
   翻译结果预览: This is a test text...
   ```

### 步骤 4：测试选中内容翻译

1. 在 Markdown 文件中选中一段中文文本
2. 右键选择 "AI 翻译: 翻译选中内容"
3. 观察选中文本是否被翻译

## 🔧 常见问题解决

### 问题 1：API 密钥错误

**症状**: 翻译失败，提示 API 密钥错误
**解决方案**:

- 检查 API 密钥是否正确
- 确认 API 服务是否可用
- 验证 API 额度是否充足

### 问题 2：网络连接问题

**症状**: 翻译超时或连接失败
**解决方案**:

- 检查网络连接
- 尝试使用代理
- 检查防火墙设置

### 问题 3：API 返回中文

**症状**: API 返回中文提示而不是翻译结果
**解决方案**:

- 检查 prompt 是否正确（已修复为英文）
- 验证 API 模型是否支持翻译
- 尝试调整 temperature 参数

### 问题 4：目标语言设置错误

**症状**: 翻译结果不是期望的语言
**解决方案**:

- 检查目标语言设置
- 确认语言代码正确（如 en, ja, ko 等）
- 重新配置语言设置

## 📊 调试检查清单

### 基础检查

- [ ] 插件已正确激活
- [ ] API 配置正确
- [ ] 网络连接正常
- [ ] 调试日志正常输出

### 翻译功能检查

- [ ] 测试翻译功能正常工作
- [ ] 选中内容翻译正常
- [ ] 文件翻译功能正常
- [ ] 翻译结果语言正确

### API 响应检查

- [ ] API 调用成功
- [ ] 返回结果格式正确
- [ ] 翻译质量良好
- [ ] 没有错误信息

## 🎯 快速修复方法

### 方法 1：重置配置

1. 打开设置面板
2. 点击"重置设置"
3. 重新配置 API 信息
4. 测试翻译功能

### 方法 2：更换 API 服务

1. 尝试不同的 API 提供商
2. 比较翻译结果
3. 选择效果最好的服务

### 方法 3：调整参数

1. 修改 temperature 参数（0.1-0.5）
2. 调整 max_tokens 设置
3. 优化 prompt 内容

## 📝 调试报告模板

```
调试时间: ____
API提供商: ____
目标语言: ____
测试结果: 成功/失败
错误信息: ____
翻译质量: 优秀/良好/一般/差
建议改进: ____
```

## 🚨 紧急修复

如果所有方法都无效，可以尝试：

1. **完全重新安装插件**
2. **使用不同的 API 服务**
3. **检查 VSCode 版本兼容性**
4. **联系 API 服务提供商**

现在请按照上述步骤进行调试，如果问题仍然存在，请提供具体的错误信息和调试日志。
